<center>Js 黑科技 </center>



[toc]







## js 黑科技

> 记录一些前端的黑科技技术





### 1. 获取电池信息

> 获取电池信息 [blog](https://mp.weixin.qq.com/s?__biz=MzAxODE2MjM1MA==&mid=2651615139&idx=1&sn=d59472bceac228d96f835194269d0218&chksm=8022b862b7553174fd6fcfa7e58639720579cefe83a96ba0efd4158bf5ccfbabfa07a1fe25e1#rd)
>
> Battery Status API的使用
>
> Battery Status API 是一个 Web API，允许 Web 应用程序访问用户设备的电池状态信息。使用这个 API，我们可以在不安装任何应用程序的情况下，从 Web 浏览器直接读取设备的电量信息。

```js
// 请求电池信息
navigator.getBattery().then(function (battery) {
    // 后续代码
    // 获取设备电量剩余百分比
    var level = battery.level //最大值为1,对应电量100%
    console.log('Level: ' + level * 100 + '%')

    // 获取设备充电状态
    var charging = battery.charging
    console.log('充电状态: ' + charging)

    // 获取设备完全充电需要的时间
    var chargingTime = battery.chargingTime
    console.log('完全充电需要的时间: ' + chargingTime)

    // 获取设备完全放电需要的时间
    var dischargingTime = battery.dischargingTime
    console.log('完全放电需要的时间: ' + dischargingTime)


    // 添加事件，当设备电量改变时触发
    battery.addEventListener('levelchange', function () {
        console.log('电量改变: ' + battery.level)
    })

    // 添加事件，当设备充电状态改变时触发
    battery.addEventListener('chargingchange', function () {
        console.log('充电状态改变: ' + battery.charging)
    })

    // 添加事件，当设备完全充电需要时间改变时触发
    battery.addEventListener('chargingtimechange', function () {
        console.log('完全充电需要时间: ' + battery.chargingTime)
    })

    // 添加事件，当设备完全放电需要时间改变时触发
    battery.addEventListener('dischargingtimechange', function () {
        console.log('完全放电需要时间: ' + battery.dischargingTime)
    })

})
```

> 大声: ==牛皮==





### 2. 全屏API

> Fullscreen API 让一个原生全屏显示

```vue
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>web</title>
    <style>
        /* WebKit 没有这样做，相反地，它将全屏元素居中，不改变大小，而屏幕的其他部分为黑色。 */
        #myvideo:-webkit-full-screen {
            width: 100%;
            height: 100%;
            background: #fff;
        }
    </style>
</head>
<body>

    <!-- <div id="myvideo">hello</div> -->

    <video style="width: 400px; height: 400px;" controls id="myvideo" >
        <source src="flower.webm"></source>
        <source src="flower.mp4"></source>
    </video>
    <button onclick="manageFullscreen()">full</button>

    <script>

        let manageFullscreen = () => {
            console.log(1)
            document.getElementById('myvideo').requestFullscreen();
        }

        let elem = document.getElementById('myvideo')
        document.addEventListener("keydown", function(e) {
        if (e.keyCode == 13) {
            toggleFullScreen();
        }
        }, false);
        
        // 浏览器前缀
        function toggleFullScreen() {
            if (!document.fullscreenElement && !document.mozFullScreenElement &&
                !document.webkitFullscreenElement && !document.msFullscreenElement) {
                // 进入全屏模式
                if (elem.requestFullscreen) {
                    elem.requestFullscreen();
                } else if (elem.mozRequestFullScreen) {
                    elem.mozRequestFullScreen();
                } else if (elem.webkitRequestFullscreen) {
                    elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) {
                    elem.msRequestFullscreen();
                }
            } else {
                // 退出全屏模式
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }

    </script>
</body>
</html>
```





### 3. 获取剪切板API

> Clipboard Async API 是一个现代的 Web API，用于在浏览器中读取和写入剪贴板内容。

```js
<input type="text" id="get_to">
    <button id="get_btn">复制</button>

    <input type="text" id="put_to">
    <button id="put_btn">粘贴</button>

    <script>
        let get_btn = document.getElementById('get_btn');
        let put_btn = document.getElementById('put_btn');

        // 点击复制按钮时触发事件
        get_btn.addEventListener('click', async () => {
            let get_to = document.getElementById('get_to').value;
            try {
                await navigator.clipboard.writeText(get_to);
                console.log(`${get_to} copied to clipboard`);
            } catch (err) {
                console.error('Failed to copy: ', err);
            }
        });

        // 点击粘贴按钮时触发事件
        put_btn.addEventListener('click', async () => {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById('put_to').value = text;
                console.log('Pasted content: ', text);
            } catch (err) {
                console.error('Failed to read clipboard contents: ', err);
            }
        });

        // 检查剪贴板支持
        if (navigator.clipboard && navigator.clipboard.read && navigator.clipboard.write) {
            console.log("剪贴板操作被支持");
        } else {
            console.log("剪贴板操作不被支持");
        }
    </script>
```

























